<div id=view>
  {{- $exp := .Expert}}
  {{- with .TargetRecord}}
  {{- $id := .Index}}
  {{- $r := .Record}}
  <div class="info">
  <table>
    <tr><th>Label:</th>
      <td>{{$r.Label}}</td>
    </tr>{{if $r.Title}}
    <tr><th>Title:</th>
      <td>{{$r.Title}}</td>
    </tr>{{end}}{{if $r.Hosts}}{{$h := index $r.Hosts 0}}
    <tr><th>Host:</th>
      <td class="pulseable copyable"><a href="{{toURL $h}}" tabindex="-1" target="_blank">{{$h}}</a></td>
    </tr>{{end}}{{if $r.Username}}
    <tr><th>Username:</th>
      <td class="pulseable copyable">{{$r.Username}}</td>
    </tr>{{end}}{{if $r.Addrs}}
    <tr><th>Address:</th>
      <td class="pulseable copyable">{{index $r.Addrs 0}}</td>
    </tr>{{end}}{{if $r.Notes}}
    <tr>
      <th>Notes:</th>
      <td><span class="prose">{{formatText $r.Notes}}</span></td>
    </tr>{{end}}
  </table>
  </div>{{/* info */}}{{/*

  Secrets section, shown only if there is a password or primary OTP code.
  Alternate OTPs are shown in the Details section below.
  
  */}}{{- if or $r.Password $r.OTP}}
  <table>
    <tr><th>Secret</th><th colspan=2>Value</th></tr>
    {{- if $r.Password}}
    <tr>
      <th>Password: </th>
      <td class="tab">
        <button id="pwvalbtn" class="tab" tabindex="-1"
                hx-get="/password/{{$id}}?vis=1"
                hx-target="#pwval"
                hx-swap="outerHTML">
          Show
        </button>
        <input id="pwval" type="hidden" value="" />
      </td>
      <td class="ctext">
        <button id="pwvalvis" tabindex=4 class="ctext pulseable copyish copyclick"
                hx-get="/password/{{$id}}"
                hx-target="#pwval"
                hx-swap="outerHTML">
          (hidden)
        </button>
        <button id="pwvalnvis" class="nvis"></button>
      </td>
    </tr>{{end}}{{if $r.OTP}}
    <tr><th>OTP:</th>
      <td class="tab">
        <button class="tab" tabindex=4
                hx-get="/totp/{{$id}}"
                hx-target="#otpval"
                hx-swap="outerHTML">
          Code
        </button>
        <input id="otpval" type="hidden" value="" />
        <button id="otpvalbtn" class="tab" tabindex="-1"
                hx-get="/totp/{{$id}}?vis=1&key=1"
                hx-target="#otpval"
                hx-swap="outerHTML">
          Show
        </button>
      </td>
      <td class="ctext">
        <button id="otpvalvis" tabindex=4 class="ctext pulseable copyish copyclick"
                hx-get="/totp/{{$id}}?key=1"
                hx-target="#otpval"
                hx-swap="outerHTML">
          (hidden)
        </button>
        <button id="otpvalnvis" class="nvis ctext"></button>
      </td>
    </tr>{{end}}{{/* OTP */}}
  </table>{{end}}{{/* secrets */}}

  {{- if $r.Details}}
  <table>
    <tr><th>Details</th><th colspan=2>Value</th></tr>
    {{range $index, $d := $r.Details}}<tr>
      <th>{{$d.Label}}</th>
      {{if $d.Hidden -}}
      <td class="tab">{{if isOTP .Value}}
        <button class="tab" tabindex=4
                hx-get="/totp/{{$id}}?detail={{$index}}"
                hx-target="#r{{$id}}d{{$index}}otp"
                hx-swap="outerHTML">
          TOTP
        </button>
        <input id="r{{$id}}d{{$index}}otp" type="hidden" value="" />{{end}}
        <button class="tab" tabindex="-1" hx-get="/detail/{{$id}}/{{$index}}" hx-target="closest tr">
          Show
        </button>
      </td>
      <td class="ctext">
        <button class="ctext pulseable copyish copyclick" tabindex=4 copy-value="{{.Value}}">
          (hidden)
        </button>
      </td>{{else}}{{- if isOTP .Value}}
      <td>
        <button class="tab" tabindex=4
                hx-get="/totp/{{$id}}?detail={{$index}}"
                hx-target="#r{{$id}}d{{$index}}otp"
                hx-swap="outerHTML">
          TOTP
        </button>
        <input id="r{{$id}}d{{$index}}otp" type="hidden" value="" />
      </td>{{end}}
      <td class="ctext" colspan="2">
        <button class="ctext notes pulseable copyable" tabindex=5>
          {{formatText .Value}}
        </button>
      </td>{{end}}
    </tr>{{end}}
  </table>{{end}}{{end -}}
</div>
